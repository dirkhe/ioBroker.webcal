{
  "version": 3,
  "sources": ["../../src/lib/iCalReadOnly.ts"],
  "sourcesContent": ["// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport { AdapterInstance } from \"@iobroker/adapter-core\";\nimport axios, { AxiosRequestConfig } from \"axios\";\nimport { initLib as IcalInit, getAllIcalCalendarEvents } from \"./IcalCalendarEvent\";\n\n//let adapter: AdapterInstance;\n\nexport function initLib(adapterInstance: AdapterInstance, localTimeZone: string): void {\n\t//adapter = adapterInstance;\n\tIcalInit(adapterInstance, localTimeZone);\n}\n\nexport class ICalReadOnlyClient implements webcal.ICalendarBase {\n\tname: string;\n\tprivate axiosOptions: AxiosRequestConfig;\n\tignoreSSL = false;\n\n\tconstructor(calConfig: webcal.IConfigCalendar) {\n\t\tthis.name = calConfig.name;\n\t\tthis.ignoreSSL = !!calConfig.ignoreSSL;\n\n\t\tthis.axiosOptions = {\n\t\t\tmethod: \"get\",\n\t\t\tresponseType: \"text\",\n\t\t\turl: calConfig.serverUrl,\n\t\t};\n\n\t\tif (calConfig.username) {\n\t\t\tthis.axiosOptions.auth = {\n\t\t\t\tusername: calConfig.username,\n\t\t\t\tpassword: calConfig.password,\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * fetch Events form Calendar and pushed them to calEvents Array\n\t * @param calEvents target Array of ICalendarEventBase\n\t * @param startDate as date object\n\t * @param endDate as date object\n\t * @returns null or errorstring\n\t */\n\tloadEvents(calEvents: webcal.ICalendarEventBase[], startDate: Date, endDate: Date): Promise<string | null> {\n\t\tlet storeDefaultIgnoreSSL: string | undefined | null = null;\n\t\tif (this.ignoreSSL && process.env.NODE_TLS_REJECT_UNAUTHORIZED != \"0\") {\n\t\t\tstoreDefaultIgnoreSSL = process.env.NODE_TLS_REJECT_UNAUTHORIZED;\n\t\t\tprocess.env.NODE_TLS_REJECT_UNAUTHORIZED = \"0\";\n\t\t}\n\t\treturn axios(this.axiosOptions)\n\t\t\t.then((response) => {\n\t\t\t\tif (response.data) {\n\t\t\t\t\tconst allEvents = getAllIcalCalendarEvents(response.data, this.name, startDate, endDate, true);\n\t\t\t\t\tfor (const i in allEvents) {\n\t\t\t\t\t\tcalEvents.push(allEvents[i]);\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t} else {\n\t\t\t\t\tthrow \"Error while reading from URL \" + this.axiosOptions.url + \": Received no data\";\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tif (error.response) {\n\t\t\t\t\treturn `Error reading from URL \"${this.axiosOptions.url}\": ${error.response.status}`;\n\t\t\t\t} else if (error.request) {\n\t\t\t\t\treturn `Error reading from URL \"${this.axiosOptions.url}\"`;\n\t\t\t\t} else {\n\t\t\t\t\treturn `Error reading from URL \"${this.axiosOptions.url}\": ${error.message}`;\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((reason: { message: any }) => {\n\t\t\t\treturn reason.message;\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tif (storeDefaultIgnoreSSL !== null) {\n\t\t\t\t\tprocess.env.NODE_TLS_REJECT_UNAUTHORIZED = storeDefaultIgnoreSSL;\n\t\t\t\t}\n\t\t\t});\n\t}\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tasync addEvent(calEvent: webcal.ICalendarEventData): Promise<any | { ok: boolean; message: string }> {\n\t\treturn {\n\t\t\tok: false,\n\t\t\tmessage: \"calender is readonly (\" + this.name + \")\",\n\t\t};\n\t}\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA,mBAA0C;AAC1C,+BAA8D;AAIvD,SAAS,QAAQ,iBAAkC,eAA6B;AAEtF,+BAAAA,SAAS,iBAAiB,aAAa;AACxC;AAEO,MAAM,mBAAmD;AAAA,EAK/D,YAAY,WAAmC;AAF/C,qBAAY;AAGX,SAAK,OAAO,UAAU;AACtB,SAAK,YAAY,CAAC,CAAC,UAAU;AAE7B,SAAK,eAAe;AAAA,MACnB,QAAQ;AAAA,MACR,cAAc;AAAA,MACd,KAAK,UAAU;AAAA,IAChB;AAEA,QAAI,UAAU,UAAU;AACvB,WAAK,aAAa,OAAO;AAAA,QACxB,UAAU,UAAU;AAAA,QACpB,UAAU,UAAU;AAAA,MACrB;AAAA,IACD;AAAA,EACD;AAAA,EASA,WAAW,WAAwC,WAAiB,SAAuC;AAC1G,QAAI,wBAAmD;AACvD,QAAI,KAAK,aAAa,QAAQ,IAAI,gCAAgC,KAAK;AACtE,8BAAwB,QAAQ,IAAI;AACpC,cAAQ,IAAI,+BAA+B;AAAA,IAC5C;AACA,eAAO,aAAAC,SAAM,KAAK,YAAY,EAC5B,KAAK,CAAC,aAAa;AACnB,UAAI,SAAS,MAAM;AAClB,cAAM,gBAAY,mDAAyB,SAAS,MAAM,KAAK,MAAM,WAAW,SAAS,IAAI;AAC7F,mBAAW,KAAK,WAAW;AAC1B,oBAAU,KAAK,UAAU,EAAE;AAAA,QAC5B;AACA,eAAO;AAAA,MACR,OAAO;AACN,cAAM,kCAAkC,KAAK,aAAa,MAAM;AAAA,MACjE;AAAA,IACD,CAAC,EACA,MAAM,CAAC,UAAU;AACjB,UAAI,MAAM,UAAU;AACnB,eAAO,2BAA2B,KAAK,aAAa,SAAS,MAAM,SAAS;AAAA,MAC7E,WAAW,MAAM,SAAS;AACzB,eAAO,2BAA2B,KAAK,aAAa;AAAA,MACrD,OAAO;AACN,eAAO,2BAA2B,KAAK,aAAa,SAAS,MAAM;AAAA,MACpE;AAAA,IACD,CAAC,EACA,MAAM,CAAC,WAA6B;AACpC,aAAO,OAAO;AAAA,IACf,CAAC,EACA,QAAQ,MAAM;AACd,UAAI,0BAA0B,MAAM;AACnC,gBAAQ,IAAI,+BAA+B;AAAA,MAC5C;AAAA,IACD,CAAC;AAAA,EACH;AAAA,EAEA,MAAM,SAAS,UAAsF;AACpG,WAAO;AAAA,MACN,IAAI;AAAA,MACJ,SAAS,2BAA2B,KAAK,OAAO;AAAA,IACjD;AAAA,EACD;AACD;",
  "names": ["IcalInit", "axios"]
}
